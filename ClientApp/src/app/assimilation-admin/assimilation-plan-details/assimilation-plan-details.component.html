<div class="assimilation-plan-details-container">

  <div class="div-headertitle">
    <label class="lblheadertitle">{{lblheader}}</label>
  </div>

  <div class="div-viewmode flex justify-content-between">
    <div>
      <label>
        <span>
          <img src="./assets/images/left-arrow.svg">
        </span>
        <span>
          <a [routerLink]="['/admin']" [queryParams]="{'view':'apt'}" class="backassm">
            Back to Assimilation plan templates
          </a>

          <!--<a (click)="discardChange()" class="backassm">
            Back to Assimilation plan templates
          </a>-->

        </span>
        <span class="planviewtext"> / Default assimilation plan_View only</span>
      </label>
    </div>
    <div class="div-bell flex flex-row justify-content-between">
      <div> <a href="javascript:void(0)" class="anc-qualtrics">Go to Qualtrics</a></div>
      <div> | </div>
      <div><img src="./assets/images/bell-icon.svg" class="bell"></div>

    </div>
  </div>

  <div class="div-defaultcontent flex flex-column justify-content-center">

    <div class="div-defaultheader flex justify-content-between"
         style="background-image: url('./assets/images/plan-header.svg') ">
      <div *ngIf="templateType != 'CreateTemplate'" class="defaultimg flex align-items-center justify-content-center">
        <img src="./assets/images/default-plan.svg" class="dimg"> {{planType}}<span class="status"
         [ngClass]="{'green': assimilationPlanDetails.info.tag == 'Active', ' gold': assimilationPlanDetails.info.tag != 'Active'}">
          <span class="dot">•</span>{{assimilationPlanDetails.info.tag}}
        </span>
      </div>
      <div *ngIf="templateType == 'CreateTemplate'" class="defaultimg flex align-items-center justify-content-center">
        <img src="./assets/images/new-plan.svg" class="dimg"> {{planType}}

        <!-- <span class="status"
        [ngClass]="{'green': pt.tag == 'Active', ' gold': pt.tag != 'Active'}"><span
          class="dot">•</span>{{ pt.tag }}</span> -->
      </div>

      <div class="default-assm flex flex-column align-items-center justify-content-center">
        <div><label>{{planName}}</label></div>
        <div class="flex flex-row justify-content-end">
          <label class="lbl-plan-assoc">{{planDescription}}</label>
          <img *ngIf="showcreateicon" (click)="showCreateDialog()" src="./assets/images/create.svg"
               style="cursor: pointer;margin-top: 0.4rem;margin-left: 1rem">
        </div>
      </div>
      <div class="flex align-items-center justify-content-center">
        <p-button *ngIf="showEditBtn" styleClass="round-btn mr-4" label="Edit" iconPos="right"
                  (click)="editMode()"></p-button>
        <p-button *ngIf="showPublishBtn" styleClass="round-btn mr-4" label="Finish" iconPos="right"
                  (click)="publishMode()"></p-button>
        <!--<p-button *ngIf="!showPublishBtn" styleClass="round-btn mr-4" label="Make a copy" iconPos="right"
            (click)="copyCurrentActivePlan()"></p-button>-->
        <!-- (click)="showCreateDialog()"></p-button> -->
        <!-- (click)="toggle()"></p-button> -->
        <!-- <button *ngIf="!showPublishBtn" class="btnEdit round-btn" icon="pi pi-check" iconPos="right"
          (click)="showSave()">Edit <span><img src="./assets/images/down-arrow.svg" class="imgdown"></span></button>
        <button *ngIf="showPublishBtn" class="btnSave round-btn" (click)="toggle()">
          Save
          <img *ngIf="templateType == 'defaultTemplate'" src="./assets/images/down-arrow.svg" class="imgdown">
        </button> -->
        <a class="backassm">
          <img src="./assets/images/cross-icon.svg" class="imgcrossicon">
        </a>

        <div *ngIf="activesave" class="overlaypopup">
          <div class="flex flex-row" style="height: 50%;border: 1px solid #D0D0CE;">
            <div class="overlaycircle flex flex-row">
              <img src="./assets/images/copy&edit.svg" class="overlayimg">
              <!-- <img src="./assets/images/save.svg" class="overlayimg"> -->
            </div>
            <div class="flex flex-column align-items-start justify-content-center">
              <label class="lblsave">Make a copy & edit </label>
              <label class="lblsavedesc">Save changes made as another template</label>
            </div>
          </div>
          <!-- <div class="flex flex-row" style="height: 50%;border: 1px solid #D0D0CE;">
            <div class="overlaycircle flex flex-row">
              <img src="./assets/images/saveas.svg" class="overlayimg">
            </div>
            <div class="flex flex-column align-items-start justify-content-center">
              <label class="lblsave">Save as...</label>
              <label class="lblsavedesc">Save the changes made as another template</label>
            </div>
          </div> -->
        </div>
      </div>
    </div>

    <div class="div-plansteps flex flex-column">
      <div class="cards">
        <ul class="ul flex flex-row justify-content-between">
          <li [ngClass]="(selectedNavItem == '01')? 'liactive': ''" (click)="navClick('01')">
            <div class="div-circle divder"><span>01</span></div>
            <div class="div-planlabel">Assign <br> Plan</div>
          </li>
          <li [ngClass]="(selectedNavItem == '02')? 'liactive': ''" (click)="navClick('02')">
            <div class="div-circle divder"><span>02</span></div>
            <div class="div-planlabel">Welcome <br> email invitation</div>

          </li>
          <li [ngClass]="(selectedNavItem == '03')? 'liactive': ''" (click)="navClick('03')">
            <div class="div-circle divder"><span>03</span></div>
            <div class="div-planlabel">Milestone & <br> tasks</div>
          </li>
          <li [ngClass]="(selectedNavItem == '04')? 'liactive': ''" (click)="navClick('04')">
            <div class="div-circle divder"><span>04</span></div>
            <div class="div-planlabel">Induction & <br> self help content</div>
          </li>
          <li [ngClass]="(selectedNavItem == '05')? 'liactive': ''" (click)="navClick('05')">
            <div class="div-circle"><span>05</span></div>
            <div class="div-planlabel">Manager <br> tasks</div>
          </li>
        </ul>
      </div>
    </div>

    <div class="assign-plan" [hidden]="!showAssgnPlan">
      <!-- <app-assign-plan *ngIf="assimilationPlanDetails.info.planId != undefined" -->
      <app-assign-plan [planId]="planId" [(assimilationPlanDetails)]="assimilationPlanDetails" [IsSaveButton]="showPublishBtn"
                       (nextTaskEvent)="setNextTask('02')"></app-assign-plan>
    </div>

    <div class="welcome-email" [hidden]="!showWelcomeEmail">
      <app-welcome-email *ngIf="assimilationPlanDetails.info.planId != undefined"
                         [(assimilationPlanDetails)]="assimilationPlanDetails" (prevTaskEvent)="setPreviousTask('01')"
                         (nextTaskEvent)="setNextTask('03')"></app-welcome-email>
    </div>

    <div class="milestone-task" [hidden]="!showMilestoneTasks">
      <app-milestone-tasks *ngIf="assimilationPlanDetails.info.planId != undefined" [IsSaveButton]="showPublishBtn"
                           [planType]="templateType" [planId]="planId" [(assimilationPlanDetails)]="assimilationPlanDetails"
                           (prevTaskEvent)="setPreviousTask('02')" (nextTaskEvent)="setNextTask('04')"></app-milestone-tasks>
    </div>

    <div class="induction-self" [hidden]="!showInductionSelf">
      <app-induction-self *ngIf="assimilationPlanDetails.info.planId != undefined" [IsSaveButton]="showPublishBtn"
                          [planType]="templateType" [planId]="planId" [(assimilationPlanDetails)]="assimilationPlanDetails"
                          (prevTaskEvent)="setPreviousTask('03')" (nextTaskEvent)="setNextTask('05')"></app-induction-self>
    </div>

    <div class="manager-tasks" [hidden]="!showManagerTasks">
      <app-manager-tasks *ngIf="assimilationPlanDetails.info.planId != undefined" [IsSaveButton]="showPublishBtn"
                         [planType]="templateType" [planId]="planId" [(assimilationPlanDetails)]="assimilationPlanDetails"
                         (prevTaskEvent)="setPreviousTask('04')"></app-manager-tasks>
    </div>

  </div>


  <p-dialog id="assmDialog" header="Assimilation plan title & description" [(visible)]="createplanvisible"
            [modal]="true" [style]="{ width: '50vw' }" [draggable]="false" [resizable]="false" (onHide)="cancel()">

    <div class="flex flex-column" style="margin-top: 1rem;">
      <label class="lbltitle">
        Assimilation plan title <span style="font-style:italic">(Maximum limit 38 characters) </span>
        <span class="star"> *</span>
      </label>
      <input type="text" class="txtplanname" pInputText [(ngModel)]="planName_temp" (keyup)="viewPlanTitleValidation()"
             maxlength="38" placeholder="Default assimilation plan" />

      <div class="form-control-feedback" *ngIf="isPlantitle">
        Plan Title is required
      </div>

      <div class="form-control-feedback" *ngIf="isPlanTitleLength">
        Plan Title should not be more than 38 charatcers
      </div>

      <div class="form-control-feedback" *ngIf="isTemplateExists">
        {{planName_temp}} is already exist, please enter new Plan title.
      </div>

    </div>

    <div class="flex flex-column" id="plandesc" style="margin-top: 1rem;">
      <label class="lbldesc">Description <span style="font-style:italic">(Maximum limit 48 characters) </span> <span class="star">*</span></label>
      <textarea pInputTextarea class="txtplanDescription" [(ngModel)]="planDescription_temp"
                (keyup)="viewPlanDescriptionValidation()" placeholder="Default assimilation for india associates" [rows]="5"
                [cols]="30" maxlength="48"></textarea>

      <div class="form-control-feedback" *ngIf="isPlanDescription">
        Plan Description is required
      </div>

      <div class="form-control-feedback" *ngIf="isPlansDescriptionLength">
        Plan Description should not be more than 48 charatcers
      </div>

    </div>

    <ng-template pTemplate="footer">
      <div class="flex flex-row justify-content-end" style="margin-top: 1rem;">
        <div><button class="btncancel" (click)="cancel()">Cancel</button></div>
        <div><button class="btnsave" (click)="save()">Save</button></div>
      </div>
    </ng-template>

  </p-dialog>

  <p-dialog styleClass="ptConfirmPopup" header="Publish plan template" [(visible)]="showPublishMandatoryAlert"
            [modal]="true">
    <ng-template pTemplate="header">
      <span class="title"><img src="./assets/images/bell_ringing.svg" /> Alert</span>
    </ng-template>
    <p>
      All mandatory fields & tasks are necessary to publish the plan template!
    </p>
    <ng-template pTemplate="footer">
      <button class="normal-round-btn " (click)="showPublishMandatoryAlert = false">
        Back
      </button>
    </ng-template>
  </p-dialog>


  <p-dialog styleClass="publishConfirmPopup" header="Publish plan template" [(visible)]="showpublishConfirmPopup"
            [draggable]="false" [resizable]="false" [modal]="true">
    <ng-template pTemplate="header">
      Confirmation: Publish changes?
    </ng-template>

    <div class="div-activationncontent">
      <div class="div-quest">
        Are you sure you want to publish the modifications done to the assimilation plan template?
      </div>
      <div class="div-descr">
        The modifications will be applicable for all the employees from the next <br /> day.
      </div>
    </div>

    <ng-template pTemplate="footer">
      <button class="normal-round-btn " (click)="showpublishConfirmPopup=false;">
        Cancel
      </button>
      <button class="round-btn" (click)="publishTemplate();">
        Publish
      </button>
    </ng-template>
  </p-dialog>


  <p-dialog styleClass="discardConfirmPopup" header="Publish plan template" [(visible)]="discardpublishConfirmPopup"
            [draggable]="false" [resizable]="false" [modal]="true">
    <ng-template pTemplate="header">
      Warning: Discard changes ?
    </ng-template>

    <div class="div-activationncontent">
      <div class="div-quest">
        Are you sure you want to discard all changes & go back?
      </div>
      <div class="div-descr">
        This action will discard all your previous actions and won’t save the modifications you made to the assimilation plan.
      </div>
    </div>

    <ng-template pTemplate="footer">
      <button class="normal-round-btn " (click)="discardChangeConfirm()">
        Discard changes
      </button>
      <button class="round-btn" (click)="discardpublishConfirmPopup=false;">
        Keep editing
      </button>
    </ng-template>
  </p-dialog>

  <p-toast position="top-center" styleClass="custom-toast"
           [ngStyle]="{'background-color': (messsageResult=='success') ? '#ABE3A5' : '#F1D2D5'}" [life]="6000">
    <ng-template let-message pTemplate="message">
      <div class="flex flex-row">
        {{message.detail}}
      </div>
    </ng-template>
  </p-toast>

</div>


